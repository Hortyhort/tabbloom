<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TabBloom Garden</title>
  <link rel="stylesheet" href="design-tokens.css">
  <link rel="stylesheet" href="sidepanel.css">
</head>
<body>
  <div class="garden-container">
    <!-- Header -->
    <header class="garden-header">
      <div class="header-left">
        <span class="header-icon" id="headerIcon" aria-hidden="true"></span>
        <div class="header-text">
          <h1 id="gardenName" class="garden-title">My Garden</h1>
          <p class="garden-subtitle" id="gardenSubtitle">12 plants thriving</p>
        </div>
      </div>
      <div class="header-actions">
        <button
          id="settingsBtn"
          class="btn-icon"
          aria-label="Open settings"
          title="Settings"
        >
          <span class="icon" id="settingsIcon" aria-hidden="true"></span>
        </button>
      </div>
    </header>

    <!-- Stats Bar -->
    <div class="stats-bar">
      <div class="stat">
        <span class="stat-icon" id="coinIcon" aria-hidden="true"></span>
        <span class="stat-value" id="coinCount">0</span>
        <span class="stat-label">coins</span>
      </div>
      <div class="stat-divider" aria-hidden="true"></div>
      <div class="stat">
        <span class="stat-icon stat-icon--healthy" id="healthyIcon" aria-hidden="true"></span>
        <span class="stat-value" id="healthyCount">0</span>
        <span class="stat-label">healthy</span>
      </div>
      <div class="stat-divider" aria-hidden="true"></div>
      <div class="stat">
        <span class="stat-icon stat-icon--wilting" id="wiltingIcon" aria-hidden="true"></span>
        <span class="stat-value" id="wiltingCount">0</span>
        <span class="stat-label">wilting</span>
      </div>
      <div class="stat-divider" aria-hidden="true"></div>
      <div class="stat stat--streak" id="streakStat" title="Your current streak">
        <span class="stat-icon stat-icon--streak" id="streakIcon" aria-hidden="true"></span>
        <span class="stat-value" id="streakCount">0</span>
        <span class="stat-label">day streak</span>
      </div>
    </div>

    <!-- Filter Bar -->
    <div class="filter-bar" role="toolbar" aria-label="Filter plants">
      <button class="filter-chip active" data-filter="all" aria-pressed="true">
        All
        <span class="filter-chip-count" id="filterCountAll">0</span>
      </button>
      <button class="filter-chip" data-filter="healthy" aria-pressed="false">
        Healthy
        <span class="filter-chip-count" id="filterCountHealthy">0</span>
      </button>
      <button class="filter-chip" data-filter="wilting" aria-pressed="false">
        Wilting
        <span class="filter-chip-count" id="filterCountWilting">0</span>
      </button>
      <button class="filter-chip" data-filter="dormant" aria-pressed="false">
        Dormant
        <span class="filter-chip-count" id="filterCountDormant">0</span>
      </button>
      <input
        type="search"
        class="filter-search"
        id="filterSearch"
        placeholder="Search..."
        aria-label="Search plants by name or domain"
      >
      <button class="filter-chip" id="selectModeToggle" aria-pressed="false" title="Select multiple plants to harvest">
        Select
      </button>
    </div>

    <!-- Garden Canvas -->
    <div id="garden-container" class="garden-scroll" role="region" aria-label="Tab garden visualization">
      <canvas id="garden-canvas" aria-hidden="true"></canvas>
      <div id="tooltip" class="tooltip hidden" role="tooltip"></div>
      <div id="scroll-hint" class="scroll-hint" aria-hidden="true"></div>
    </div>

    <!-- Quick Actions -->
    <div id="quick-actions" class="quick-actions" role="toolbar" aria-label="Quick actions">
      <button
        id="quickStats"
        class="btn-icon btn-icon--sm"
        aria-label="View garden statistics"
        title="Stats"
      >
        <span class="icon" aria-hidden="true"></span>
      </button>
      <button
        id="quickShare"
        class="btn-icon btn-icon--sm"
        aria-label="Share your garden"
        title="Share"
      >
        <span class="icon" aria-hidden="true"></span>
      </button>
      <button
        id="quickRefresh"
        class="btn-icon btn-icon--sm"
        aria-label="Refresh garden"
        title="Refresh"
      >
        <span class="icon" aria-hidden="true"></span>
      </button>
    </div>

    <!-- Footer -->
    <footer class="garden-footer">
      <button id="harvestAll" class="btn-primary harvest-btn" aria-label="Harvest all wilted tabs" title="Close all wilting tabs and earn coins">
        <span class="btn-icon-left" id="harvestIcon" aria-hidden="true"></span>
        <span>Harvest Wilted</span>
      </button>
      <p class="stats-text" id="weeklyStats">0 tabs bloomed this week</p>
    </footer>
  </div>

  <!-- Batch Action Bar -->
  <div id="batchActionBar" class="batch-action-bar" role="toolbar" aria-label="Batch actions">
    <div class="batch-info">
      <span class="batch-count" id="batchCount">0</span>
      <span>selected</span>
    </div>
    <div class="batch-actions">
      <button class="btn-text" id="batchSelectAll" title="Select all plants">Select All</button>
      <button class="btn-text" id="batchCancel" title="Exit selection mode">Cancel</button>
      <button class="btn-primary btn-sm" id="batchHarvest" aria-label="Harvest selected plants" title="Harvest selected plants">
        Harvest
      </button>
    </div>
  </div>

  <!-- Onboarding Overlay -->
  <div id="onboarding" class="onboarding-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="onboardingTitle">
    <div class="onboarding-card">
      <div class="onboarding-icon" id="onboardingFlower" aria-hidden="true"></div>
      <h2 id="onboardingTitle">Welcome to TabBloom</h2>
      <p class="onboarding-subtitle">Your browser tabs are now seeds in a digital garden.</p>
      <ul class="onboarding-tips" role="list">
        <li>
          <span class="tip-icon" aria-hidden="true"></span>
          <span>Active tabs bloom beautifully</span>
        </li>
        <li>
          <span class="tip-icon tip-icon--wilting" aria-hidden="true"></span>
          <span>Neglected tabs slowly wilt</span>
        </li>
        <li>
          <span class="tip-icon tip-icon--coin" aria-hidden="true"></span>
          <span>Harvest wilted tabs to earn coins</span>
        </li>
        <li>
          <span class="tip-icon tip-icon--share" aria-hidden="true"></span>
          <span>Share your garden with friends</span>
        </li>
      </ul>
      <button id="onboardingClose" class="btn-primary onboarding-btn">
        Start Growing
      </button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <script src="icons.js"></script>
  <script src="garden.js"></script>
  <script>
    // Initialize icons after DOM loads
    document.addEventListener('DOMContentLoaded', () => {
      // Header icons
      Icons.insert(document.getElementById('headerIcon'), 'flower', 24);
      Icons.insert(document.querySelector('#settingsBtn .icon'), 'settings', 20);

      // Stats bar icons
      Icons.insert(document.getElementById('coinIcon'), 'coin', 16);
      Icons.insert(document.getElementById('healthyIcon'), 'leaf', 16);
      Icons.insert(document.getElementById('wiltingIcon'), 'leafDroop', 16);
      Icons.insert(document.getElementById('streakIcon'), 'fire', 16);

      // Quick action icons
      Icons.insert(document.querySelector('#quickStats .icon'), 'chart', 18);
      Icons.insert(document.querySelector('#quickShare .icon'), 'camera', 18);
      Icons.insert(document.querySelector('#quickRefresh .icon'), 'refresh', 18);

      // Footer icons
      Icons.insert(document.getElementById('harvestIcon'), 'harvest', 18);

      // Onboarding icons
      Icons.insert(document.getElementById('onboardingFlower'), 'seedling', 48);
      document.querySelectorAll('.tip-icon').forEach((el, i) => {
        const icons = ['flower', 'leafDroop', 'coin', 'share'];
        Icons.insert(el, icons[i], 20);
      });
    });
  </script>
</body>
</html>
